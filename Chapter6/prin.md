# 6 예측 가능한 코드를 작성하라
## 목차
- [6.1 매직값을 반환하지 말아야 한다](#61-매직값을-반환하지-말아야-한다)
- [6.2 널 객체 패턴을 적절히 사용하라](#62-널-객체-패턴을-적절히-사용하라)
- [6.3 예상치 못한 부수 효과를 피하라](#63-예상치-못한-부수-효과를-피하라)
- [6.4 입력 매개변수를 수정하는 것에 주의하라](#64-입력-매개변수를-수정하는-것에-주의하라)
- [6.5 오해를 일으키는 함수는 작성하지 말라](#65-오해를-일으키는-함수는-작성하지-말라)
- [6.6 미래를 대비한 열거형 처리](#66-미래를-대비한-열거형-처리)

## 6.1 매직값을 반환하지 말아야 한다
- 버그가 발생할 수 있다.
```java
class User {
    private final Integer age;

    int getAge() {
        if (age == null) {
            return -1;
        }
        return age;
    }
}

// getAge()을 호출하는 쪽
int getTotalAge(List<User> users) {
    int total = 0;
    for (User user : usrs) {
        total += user.getAge(); // -> -1이 섞인다
    }
    return total;
}
```
단위 테스트에서 문제를 발견하지 못할 수도 있다. age가 null이 아니라는 확고한 믿음이 있기 때문<br>
따라서 널이 가능한 유형 또는 Optional를 리턴한다.

## 6.2 널 객체 패턴을 적절히 사용하라
> 널 객체 패턴: 빈 컬렉션 또는 배열을 리턴해서 Null 체킹이 전파되는 문제를 줄인다.
- null을 리턴하면 호출하는 곳에서도 null에 대한 처리를 해야 한다. 비어있는 컬렉션을 리턴하는 것이 대안이 될 수 있다.
- 적절히 사용해서 호출하는 쪽이 문제없이 호출할 수 있어야 한다.
    - 문자열 ID가 빈 문자열 `""`을 리턴하면 항상 값이 존재할 거라고 생각하게 된다.
    - 머그잔 재고가 없어서 크기가 0인 머그잔을 리턴하면 예상하지 못한 시나리오로 흘러간다.

-> 널 안정성과 옵셔널을 사용하게 되면서 널 객체 패턴의 사용에 대한 설득력이 많이 떨어졌다.

## 6.3 예상치 못한 부수 효과를 피하라
- 분명하고 의도적인 것은 괜찮다.
    - 목적: 에러 메시지 표시하기
    - side effect: 메시지로 캔버스 업데이트
- 예기치 않은 것은 문제가 될 수 있다.
    - 목적: 픽셀 색상 읽기
    - side effect: 캔버스 다시 그리기<br>
    -> 비용이 큰 작업이라면? 하나의 픽셀마다 다시 그린다면 4k는?

"부수 효과를 아예 피하거나 그렇지 못하면 발생 사실을 명백히 드러내라"
-> **메서드명에 정보 제공**

## 6.4 입력 매개변수를 수정하는 것에 주의하라
> 자바는 기본적으로 Pass By Value 이지만 참조타입은 Pass By Reference 처럼 작동한다.

파라미터로 받은 변수를 수정했을 때 버그가 발생할 가능성이 있다면
- 변경하기 전에 복사 -> 메모리와 CPU 성능에 영향을 미치지만 버그와 비교하면 크게 문제되지 않는다.

## 6.5 오해를 일으키는 함수는 작성하지 말라
`displayXXX()`가 null을 받아들이고 아무것도 하지 않는다. -> 무엇가 보여줄 것을 기대하는데 왜 아무것도 안하지? <br>
코드를 까보면 null이면 아무것도 하지 않도록 되어있다. -> null 아닌 값으로 호출해야 한다는 것을 나중에 인지하게 된다. (인지 못할 수도 있고)

- 중요한 파라미터는 필수로 만들어라
- `@CheckReturnValue`
> 코드를 명확하게 작성하는 것의 이점은 코드를 몇 줄 추가하는 비용을 훨씬 능가한다.

> 질문: 자바에서 파라미터 not null을 강제하는 방법? <br>
*Lombok @NonNull*

## 6.6 미래를 대비한 열거형 처리
```java
public enum A{
    FIRST,
    SECOND;

    Boolean isSafe() {
        return this == FIRST;
    }
}
```
열거값 확장에 대비해야 한다. `THIRD`를 추가하고 true를 반환하길 원하지만 여전히 false를 리턴한다.

- switch 문 사용하기
    - default 사용 x -> 열거값이 추가되면 컴파일러가 잡지 못함
