# 2. 추상화 계층

<!-- TOC -->

* [2. 추상화 계층](#2-추상화-계층)
    * [2.2 왜 추상화 계층을 만드는가?](#22-왜-추상화-계층을-만드는가)
        * [코드를 작성한다는 것?](#코드를-작성한다는-것)
        * [추상화 계층이란?](#추상화-계층이란)
        * [추상화 계층 및 코드 품질의 핵심 요소](#추상화-계층-및-코드-품질의-핵심-요소)
    * [2.3 코드의 계층](#23-코드의-계층)
        * [추상화 계층을 만드는 방법](#추상화-계층을-만드는-방법)
        * [함수](#함수)
        * [클래스](#클래스)
        * [인터페이스](#인터페이스)
        * [층이 너무 얇아질 때](#층이-너무-얇아질-때)

<!-- TOC -->

## 2.2 왜 추상화 계층을 만드는가?

### 코드를 작성한다는 것?

- 코드 작성의 목적은 문제 해결이다.
- 코드 작성은 복잡한 문제를 계속해서 더 작은 하위 문제로 세분화하는 작업이다.
- 코드를 잘 구성한다는 것은 `간결한 추상화 계층(layers of abstraction)`을 만드는 것이다.

### 추상화 계층이란?

- 하나의 문제가 있을 때, 이 문제와 하위 문제에 대한 해결책이 일련의 층을 형성하고 있는데, 이를 `추상화 계층`이라고 한다.
- 문제가 엄청 복잡해도, 하위 문제들을 식별하고 올바른 추상화 계층을 만듦으로 복잡한 문제를 쉽게 다룰 수 있다.

### 추상화 계층 및 코드 품질의 핵심 요소

**추상화 계층. 이를 잘 다루면 다음과 같은 이점이 있다.**

- `가독성` : 개발자가 한 번에 한두 개 정도의 계층과 몇 개의 개념만 다루면 되기 때문에, 가독성이 향상된다.
- `모듈화` : 다른 계층이나 코드의 일부에 영향을 미치지 않고 계층 내에서만 구현을 변경하기 쉬워진다.
- `재사용성 및 일반화성` : 하위 문제에 대한 해결책을 재사용하기 쉬워지며, 해결책이 여러 다른 상황에서 일반화될 가능성이 커짐
- `테스트 용이성` : 각 하위 문제에 대한 해결책을 완벽하게 테스트하는 것이 쉬워진다.

## 2.3 코드의 계층

### 추상화 계층을 만드는 방법

- 추상화 계층을 생성하는 방법은 서로 다른 단위로 분할해 단위 간의 의존 관계를 보여주는 의존성 그래프를 생성하는 것이다.
- 함수, 클래스, 인터페이스, 패키지 등을 사용해 코드를 다른 단위로 나눌 수 있다.
- API는 호출하는 쪽에 공개할 개념만 정의하고, 이외의 모든 것은 구현 세부 사항이기 때문에 코드를 API의 관점에서 생각하면 추상화 계층을 만드는데 도움이 된다.

### 함수

```
makeCoffie() {
        물을끓인다();
        믹스커피를_넣는다();
}
```

- 각 함수에 포함된 코드가 하나의 잘 써진 짧은 문장처럼 보이면 이상적이다.
- 함수가 하는 일을 다음 중 하나로 제한하면 유익하다.
    - 단일 업무를 수행
    - 잘 명명된 다른 함수를 호출해서 더 복잡한 동작 구성

**(결론) 함수를 작게 만들고 수행하는 작업을 명확하게 하면 코드의 가독성과 재사용성이 높아진다.**

### 클래스

**단일 클래스의 이상적인 크기에 대한 이론 및 경험 법칙을 소개한다.**

- `응집력(cohesion)` : 한 클래스 내의 모든 요소들이 얼마나 잘 속해 있는지를 보여주는 척도
    - 순차적 응집력 : 한 요소의 출력이 다른 요소에 대한 입력으로 필요할 때 발생
    - 기능적 응집력 : 몇 가지 요소들이 모여서 하나의 일을 성취하는 데 기여할 때 발생
- `관심사의 분리(separation of concerns)` : 시스템이 각각 별개의 문제를 다루는 개별 구성 요소로 분리되어야 한다고 주장하는 설계 원칙

**(결론) 코드를 적절한 크기의 클래스로 세분화하는 것은 추상화 계층을 잘 만들기 위한 가장 효과적인 도구이다.
만약, 코드를 적절한 크기의 클래스로 쪼개지 않는다면, 너무 많은 개념을 한번에 다뤄야 하고
가독성이 낮고, 모듈화 덜 이루어지며, 재사용과 일반화 어렵고, 테스트하기 어렵다.**

### 인터페이스

- 계층 사이를 뚜렷하게 구분하고 구현 세부 사항이 계층 사이에 유출되지 않도록 인터페이스를 사용할 수 있다.
- 추상화 계층을 나타내기 위한 인터페이스를 정의함으로 주어진 하위 문제를 해결하는 구현 클래스를 쉽게 교체 가능하다.(모둘화 및 설정 가능)
- 더 많은 작업이 생기고, 코드가 복잡해질 수도 있다. (대신, 퍼블릭 API가 명확해지고 테스트하기 쉬워진다.)
- 정답은 없다. 하지만 적어도. 맹목적으로 인터페이스만을 위한 인터페이스를 작성해서는 안된다.

### 층이 너무 얇아질 때

- 분할을 위한 분할은 의미가 없다. 비용이 이익보다 더 큰 시점이 올 수 있는 상식에 맞게 적용하라.
- 코드 계층의 규모를 올바르게 결정하는 것은 중요하다.
- 코드 베이스에 `의미 있는 추상화 계층`이 없다면 전혀 관리할 수 없는 코드가 된다.
- 최선의 조언은 자신이 만든 계층이 코드의 가독성을 높이고, 재사용 및 일반화 가능하며, 모듈화되고, 테스트를 용이하게 하는지 스스로 판단하고 신중하게 생각해보는 것이다.