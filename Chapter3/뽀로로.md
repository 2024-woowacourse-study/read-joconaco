# 3. 다른 개발자와 코드 계약

---

## 3.1 자신의 코드와 다른 개발자의 코드
자신이 작성한 코드가 독립적으로 존재하는 경우는 거의 없다. 
다른 개발자들이 작성한 코드에 의존할 것이고, 다른 엔지니어들 또한 여러분의 코드에 의존하는 코드를 작성할 것이다.

코드를 작성할 때 다음 세 가지를 고려하는 것이 유용하다.
- 자신에게 명백하다고 해서 다른 사람에게도 명백한 것은 아니다.
- 다른 개발자는 무의식중에 여러분의 코드를 망가뜨릴 수 있다.
- 시간이 지남에 따라 자신의 코드를 기억하지 못한다.

### 3.1.1 자신에게 분명하다고 해서 다른 사람에게도 분명한 것은 아니다.
자신이 코드를 작성할 당시에 너무도 분명해 보였던 것들이 다른 사람에게는 분명하지 않을 것이다.

이를 해결하기 위해, 코드를 이해하기 쉽고 코드 자체로 설명이 되게 하는 것이 좋은 방법이다.

### 3.1.2 다른 개발자는 무의식중에 여러분의 코드를 망가뜨릴 수 있다.
다른 개발자들이 우리의 코드를 접할 때 그 코드가 왜 존재하는지 혹은 무슨 일을 수행하는지에 대한 사전 지식을 가지고 있지 않을 수 있다. 
이 경우 다른 개발자가 의도치 않게 잘 실행되던 코드를 작동하지 않게 하거나 오용하는 방식으로 코드를 추가하거나 수정할 가능성이 크다.

다른 개발자의 코드 변경으로 인해 우리의 코드가 작동하지 않거나 오용하는 결과를 가져온다면, 그 코드는 이 문제가 해결되기 전까지 코드베이스에 병합되면 안된다. 

이를 위해 신뢰할 만한 방법으로는, 무언가 문제가 있을 때 `코드 컴파일이 중지되거나 테스트가 실패하도록 만드는 것`이다.

### 3.1.3 시간이 지나면 자신의 코드를 기억하지 못한다.
1~2년 전에 작성한 코드를 다시 들여다보는 일은 다른 사람이 작성한 코드를 보는 것과 크게 다르지 않다.

배경지식이 거의 없거나 전혀 없는 사람에게도 자신의 코드가 이해하기 쉬어야 하고, 잘 작동하던 코드에 버그가 발생하는 것이 어려워야 한다.
이렇게 하는 것은 다른 사람에게 호의를 베푸는 것이기도 하지만 미래의 자신에게도 유익한 일이다.

---

## 3.2 여러분이 작성한 코드의 사용법을 다른 사람들은 어떻게 아는가?
우리가 작성한 코드를 다른 개발자가 어떻게 사용해야 하는지 알아내기 위한 방법은 다음과 같다.
- 함수, 클래스, 열거형 등의 이름을 살펴본다.
- 함수와 생성자의 매개변수 유형 또는 반환값의 유형 같은 데이터 유형을 살펴본다.
- 함수/클래스 수준의 문서나 주석문을 읽어본다.
- 직접 와서 묻거나 채팅/이메일을 통해 문의한다.
- 여러분이 작성한 함수와 클래스의 자세한 구현 코드를 읽는다.

___

## 3.3 코드 계약
코드의 계약에 대한 용어
- **선결 조건**: 코드를 호출하기 전에 사실이어야 하는 것
- **사후 조건**: 코드가 호출된 후에 사실이어야 하는 것
- **불변 사항**: 코드가 호출되기 전과 후에 시스템 상태를 비교해서 변경되지 않아야 하는 사항

코드에서 계약을 정의할 때도 명확한 부분과 세부 조항이 있다.
- 계약의 명확한 부분
  - 함수와 클래스 이름
  - 인자 유형
  - 반환 유형
  - 검사 예외
- 세부 조항
  - 주석문과 문서
  - 비검사 예외

### 3.3.2 세부 조항에 너무 의존하지 말라
문서화의 중요성에도 불구하고 다른 개발자들이 그것을 읽지 않을 가능성이 크거나, 
업데이트가 안 될 가능성이 크기 때문에 문서화는 이상적인 방법은 아니다.

---

## 3.4 체크 및 어서션

### 3.4.1 체크
체크는 시행 중인 계약 조건에 따라 다음과 같은 범주로 구분된다.
- **전제 조건 검사**: 입력 인수가 올바르거나, 초기화가 수행되었거나, 일부 코드를 수행하기 전에 시스템이 유효한 상태인지 확인하는 경우
- **사후 상태 검사**: 반환값이 올바르거나 일부 코드를 실행 한 후 시스템이 유효한 상태인지 확인하는 경우

### 3.4.2 어서션
어서션은 체크와 거의 같은 방식으로 동작한다. 조건이 위반되면 오류가 명백하게 보이거나 예외가 발생한다.

어서션과 체크 사이의 주요 차이점은 배포를 위해 빌드할 때 어서션은 보통 컴파일에서 제외된다는 점이며,
이는 코드가 실제 서비스 환경에서 사용될 때 실패를 명백하게 보여주지 않는다는 것을 의미한다.

---

## 요약
- 코드베이스는 계속 변하고 일반적으로 여러 개발자에 의해 변경된다.
- 다른 개발자가 어떻게 코드를 해석하고 오용할 수 있을지 생각해보고, 이러한 가능성을 최소화하거나 오용이 불가능하게 만드는 방식으로 코드를 작성하는 것이 유용하다.
- 코드를 작성할 때 일종의 코드 계약이 항상 만들어진다. 여기에는 명백한 항목이나 세부 조항과 같은 내용이 포함될 수 있다.
- 코드 계약의 세부 조항은 다른 개발자가 계약을 준수하도록 하기 위한 방법이지만 신뢰할만한 방법은 아니다. 보통 더 나은 접근법은 명백한 항목으로 계약의 내용을 전달하는 것이다.
- 일반적으로 컴파일러를 사용하여 계약을 확인하는 것이 가장 신뢰할 수 있는 방법이다. 이것이 가능하지 않을 때, 체크나 어서션을 사용하여 실행 시간에 계약을 확인할 수 있다.
