# 좋은 코드, 나쁜 코드 (9) 코드를 재사용하고 일반화할 수 있도록 하라

date: March 3, 2024
preview: 좋은 코드, 나쁜 코드 9장을 읽고 정리한 글입니다.

---

### 💭 가정을 주의하라

가정은 코드 재사용 시 버그를 초래할 수 있다. 가정은 코드를 간결하게 하기도 하지만 불필요한 사용은 자제해야 한다. 


가정이 필요하면 다음과 같이 해라. 

- 가정이 ‘깨지지 않게’ 만들라.
- 오류 전달 기술을 사용하라.

다음은 한 가지 예시이다. 어서션을 통해서 Article을 사용하려는 개발자에게 가정을 명확하게 알리고 있다. 


### 💭 전역 상태를 주의하라

전역 상태의 문제점은 재사용하기에 안전하지 않다는 점이다. 이유는 상태를 계속 갖고 있기 때문이다. 여러 인스턴스에서 전역 상태를 임의로 수정하는 상황에서 의도치 않은 결과가 발생하기 쉽다. 이를 해결하는 방법은 전역 상태를 인스턴스의 상태로 바꾸고 의존성을 주입하는 것이다. 

### 💭 기본 반환값을 적절하게 사용하라

낮은 계층에서 코드의 기본 반환값은 재사용성을 해친다. 낮은 계층에서부터 기본 반환값이 올라온다면, 그에 대한 의존성으로 상위 계층도 동일하게 기본 반환값을 전달하기 때문이다. 


### 💭 함수의 매개변수를 주목하라

필요 이상으로 매개변수를 받는 함수는 재사용하기 어려울 수 있다. 

다음 코드에서 setTextColor()는 TextOptions에 텍스트 색상만 사용한다. 하지만 TextOptions를 통째로 매개변수로 전달받고 있다. 


이 코드의 문제는 호출하는 부분에서 드러난다. 


이에 대한 해결책은 필요한 것만 매개변수로 받는 것이다. 


### 💭 제네릭의 사용을 고려하라

다음이 제네릭의 예시이다. 


제네릭이 아닌, 특정 유형에 의존하면 일반화를 제한한다. 다음 코드는 values가 String에 의존하고 있어서 재사용이 어렵다. 


다음과 같이 제네릭을 사용하면 특정 클래스에 대한 의존성이 낮아지고, 재사용성이 높아진다. 


### 💭 요약

- 동일한 하위 문제가 자주 발생하므로 코드를 재사용하면 미래의 자신과 팀 동료의 시간과 노력을 절약할 수 있다.
- 다른 개발자가 여러분이 해결하려는 문제와는 다른 상위 수준의 문제를 해결하더라도 특정 하위 문제에 대해서는 여러분이 작성한 해결책을 재사용할 수 있도록 근본적인 하위 문제를 식별하고 코드를 구성하도록 노력해야 한다.
- 간결한 추상화 계층을 만들고 코드를 모듈식으로 만들면 코드를 재사용하고 일반화하기가 훨씬 쉽고 안전해진다.
- 가정을 하게 되면 코드는 종종 더 취약해지고 재사용하기 어렵다는 측면에서 비용이 발생한다.
    - 가정을 하는 경우의 이점이 비용보다 큰지 확인하라.
    - 가정을 해야 할 경우 그 가정이 코드의 적절한 계층에 대해 이루어지는 것인지 확인하고 가능하다면 가정을 강제적으로 적용하라.
- 전역 상태를 사용하면 특히 비용이 많이 발생하는 가정을 하는 것이 되고 재사용하기에 전혀 안전하지 않은 코드가 된다. 대부분의 경우 전역 상태를 피하는 것이 가장 바람직하다.