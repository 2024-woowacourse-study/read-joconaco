# 좋은 코드, 나쁜 코드 (4) 오류

date: February 28, 2024

---

### 💭 복구 가능성

오류는 다음 두 가지로 분류된다. 

- 복구 가능한 오류
    - 네트워크 오류가 발생하면 연결을 재시도할 수 있다.
    - 중요하지 않은 작업에서 오류가 발생한다면, 시스템을 계속해도 괜찮다.
- 복구할 수 없는 오류
    - 잘못된 입력 인수로 호출
    - 일부 필요한 상태를 사전에 초기화하지 않음

오류를 복구할 방법이 있다면, 개발자는 문제를 빨리 발견하고 해결하는 것이 좋다. 여기에서 **신속한 실패**와 요란한 **실패의 개념**이 나온다. 

### 💭 견고성 vs 실패

오류를 대처하는 방법은 다음 중 하나이다. 

- 더 높은 코드 계층이 처리하거나 전체 프로그램이 작동을 멈춘다.
- 오류를 처리하고 계속 진행한다.

**신속하게 실패하라**

가능한 한 문제의 발생 지점으로부터 가까운 곳에서 오류가 나타나게 하는 것이다. 신속한 실패의 장점은 다음과 같다. 

- 발생하자마자 바로 실패나 오류를 보여주지 않으면 문제가 발생할 때 디버그하기 어렵다.
- 코드가 제대로 작동하지 않거나 잠재적으로 문제를 일으킬 수 있다.

**요란하게 실패하라**

오류가 발생하는데도 아무도 모른다면 고칠 방법이 없다. 요란한 실패는 이를 대처하기 위한 수단이다. 

다음은 오류를 처리하는 좋지 않은 방법이다.

- 기본값 반환 Ex) -1
- 아무것도 하지 않음

### 💭 **오류 전달 방법**

오류가 발생하면 일반적으로 더 높은 계층으로 오류를 알려야 한다. 전달하는 방법에는 크게 2가지가 있다. 

- 명시적 방법
    
    코드를 직접 호출한 쪽에서 오류가 발생할 수 있음을 인지할 수 밖에 없도록 한다. 
    
- 암시적 방법
    
    코드를 호출하는 쪽에 오류를 알리지만, 호출하는 쪽에서 그 오류를 신경쓰지 않아도 된다.
    


자바는 검사 예외(checked exception)와 비검사 예외(unchecked exception)의 개념을 모두 가지고 있다. 예외를 지원하는 대부분의 주요 언어는 비검사 예외만 가지고 있으므로 자바 이외의 거의 모든 언어에서 예외라는 용어는 일반적으로 비검사 예외를 의미한다.

**명시적 방법: 검사 예외 → checked exception**

컴파일러는 검사 예외에 대해 호출하는 쪽에서 예외를 인지하도록 강제적으로 조치하는데, 호출하는 쪽에서는 예외 처리를 위한 코드를 작성하거나 자신의 함수 시그니처에 해당 예외 발생을 선언해야 한다. 따라서 검사 예외를 사용하는 것은 오류를 전달하기 위한 명시적인 방법이다.

**암시적 방법: 비검사 예외 → unchecked exception**

비검사 예외를 사용하면 다른 개발자들은 코드가 이 예외를 발생시킬 수 있다는 사실을 전혀 모를 수 있다. 따라서 비검사 예외는 오류가 발생할 수 있다는 것을 호출하는 쪽에서 인지하리라는 보장이 없기 때문에 오류를 암시적으로 알리는 방법이다.

### 💭 요약

- 오류에는 크게 두 가지 종류가 있다.
    - 시스템이 복구할 수 있는 오류
    - 시스템이 복구할 수 없는 오류
- 해당 코드에 의해 생성된 오류로부터 복구할 수 있는지 여부를 해당 코드를 호출하는 쪽에서만 알 수 있는 경우가 많다.
- 에러가 발생하면 신속하게 실패하는 것이 좋고, 에러를 복구할 수 없는 경우에는 요란하게 실패하는 것이 바람직하다.
- 오류를 숨기는 것은 바람직하지 않을 때가 많으며, 오류가 발생했다는 신호를 보내는 것이 바람직하다.
- 오류 전달 기법은 두 가지 범주로 나눌 수 있다.
    - 명시적 방법: 코드 계약의 명확한 부분. 호출하는 쪽에서는 오류가 발생할 수 있음을 인지한다.
    - 암시적 방법: 코드 계약의 세부 조항을 통해 오류에 대한 설명이 제공되거나 전혀 설명이 없을 수도 있다. 오류가 발생할 수 있다는 것을 호출하는 쪽에서 반드시 인지하는 것은 아니다.
- 복구할 수 없는 오류에 대해서는 암시적 오류 전달 기법을 사용해야 한다.